<!DOCTYPE html>
<html lang="en">

<head>
    <title>Joanina Alves</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="ueberschrift">
        <h1>Joanina Alves</h1>
        <br><br><br><br><br>
    </div>
    
    <div class="kommentar" id="commentsContainer"></div>
    
    <div>
        <textarea id="commentInput" placeholder="Kommentar eingeben"></textarea>
        <input type="text" id="nameInput" placeholder="Dein Name" />
        <button id="submitComment">Kommentar absenden</button>
    </div>
    
    <br>
    
    <div class="impressum">
        <a href="index.html" style="text-decoration: none" class="link">- Zurück -</a>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js"></script>

    <script>
        // Firebase-Konfiguration
        const firebaseConfig = {
            apiKey: "DEIN_API_KEY",
            authDomain: "DEIN_AUTH_DOMAIN",
            projectId: "DEIN_PROJECT_ID",
            storageBucket: "DEIN_STORAGE_BUCKET",
            messagingSenderId: "DEIN_MESSAGING_SENDER_ID",
            appId: "DEIN_APP_ID"
        };

        // Firebase initialisieren
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Beispiel: Die Schüler-ID, die von der URL oder einer anderen Quelle kommt
        const schuelerId = "btgj21_joanina_alves";  // Dies kannst du dynamisch setzen, z.B. aus der URL

        const commentInput = document.getElementById("commentInput");
        const submitCommentButton = document.getElementById("submitComment");
        const commentsContainer = document.getElementById("commentsContainer");

        // Kommentarfunktion: Kommentar speichern
        submitCommentButton.addEventListener("click", async (e) => {
            e.preventDefault();  // Verhindert das Standardverhalten des Buttons (z.B. Form-Submit)

            const comment = commentInput.value.trim();
            const name = document.getElementById("nameInput").value.trim();  // Optional, wenn du den Namen speichern möchtest

            if (comment) {
                try {
                    // Kommentar in der Schüler-Sammlung speichern
                    await db.collection("schueler")
                        .doc(schuelerId)  // Zugriff auf das Dokument des spezifischen Schülers
                        .collection("kommentare")  // Unter-Sammlung für Kommentare
                        .add({
                            text: comment,
                            name: name || "Anonym",  // Fallback auf "Anonym", wenn kein Name angegeben wurde
                            timestamp: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    commentInput.value = "";  // Eingabefeld zurücksetzen
                } catch (error) {
                    console.error("Fehler beim Speichern des Kommentars:", error);
                }
            }
        });

        // Funktion zum Laden der Kommentare des Schülers
        const loadComments = () => {
            db.collection("schueler")
                .doc(schuelerId)  // Zugriff auf das Dokument des spezifischen Schülers
                .collection("kommentare")  // Unter-Sammlung für Kommentare
                .orderBy("timestamp", "desc")  // Kommentare nach Zeitstempel absteigend sortieren
                .onSnapshot((snapshot) => {
                    commentsContainer.innerHTML = "";  // Container leeren
                    snapshot.forEach((doc) => {
                        const comment = doc.data().text;
                        const name = doc.data().name;
                        const commentDiv = document.createElement("div");
                        commentDiv.classList.add("comment");
                        commentDiv.innerHTML = `<strong>${name}</strong>: ${comment}`;
                        commentsContainer.appendChild(commentDiv);
                    });
                });
        };

        // Kommentare laden, wenn die Seite geladen wird
        loadComments();
    </script>

</body>

</html>



